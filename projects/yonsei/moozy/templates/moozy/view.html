{% load static %}
<link rel="stylesheet" href="{% static 'moozy/style.css' %}">
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Moozy â€” ë³´ê¸°</title>
  <link rel="stylesheet" href="{% static 'moozy/style.css' %}">
</head>
<body class="moozy-page">
  <header class="moozy-header">
    <nav class="steps">
      <button class="step done">ì—…ìŠµëŸ¬ í¸ì§‘ëœ ë³´ê¸°</button>
      <button class="step">ë‚ ì§œ ì„ íƒ</button>
      <button class="step">ë‚´ê°€ ë³¸ ì¼ê¸° ë³´ê¸°</button>
    </nav>
  </header>
<div class="status-bar">
  <div class="status-left" id="clock">00:00</div>
  <div class="status-right">
    <span class="icon-signal"></span>
    <span class="icon-wifi"></span>
    <span class="icon-battery">
      <span class="battery-fill" id="battery-fill"></span>
    </span>
  </div>
</div>
  <main class="moozy-main">
    <section class="hero">
      <h1>OOOì—ì„œ ë‚ ì”¨ ë‚˜ë§Œì˜ ë·°ë¥¼ ì„¤ì •í•˜ì„¸ìš”.</h1>
      <p class="subtitle">ì›í•˜ëŠ” ë‚ ì§œë¥¼ ì„ íƒí•˜ê³  ê·¸ë‚ ì˜ ë‚ ì”¨/ë©”ëª¨ë¥¼ ì €ì¥í•´ë³´ì„¸ìš”.</p>
    </section>

    <section class="calendar-preview">
      <div class="calendar-box">
        <!-- ë‹¬ë ¥ ë¯¸ë¦¬ë³´ê¸°(ì„ íƒ í˜ì´ì§€ë¡œ ì´ë™) -->
        <div class="calendar-placeholder">
          <p class="month">October</p>
          <div class="mini-calendar">
            <!-- ì‹¤ì œ ë‹¬ë ¥ì€ select í˜ì´ì§€ì˜ calendar.jsë¡œ ë Œë”ë§ -->
            <p>ë‹¬ë ¥ ë¯¸ë¦¬ë³´ê¸° ì˜ì—­</p>
          </div>
        </div>
      </div>

      <div class="today-card">
        <p class="date">2023ë…„ 10ì›” 30ì¼</p>
        <p class="weather">ì˜¤ëŠ˜ì€ ì‹œì›í•œ ê°€ì„ë°”ëŒì´ ë¶ˆì–´ì˜¤ëŠ” ë‚ ì”¨ì—ìš” ğŸƒğŸ‚</p>
      </div>
    </section>

    <section class="actions">
      <a href="{% url 'moozy:select' %}" class="btn primary">ë‚ ì§œ ì„ íƒí•˜ëŸ¬ ê°€ê¸°</a>
      <a href="{% url 'moozy:confirm' %}" class="btn secondary">ë‚´ê°€ ë³¸ ì¼ê¸° ë³´ê¸°</a>
    </section>
  </main>

  <footer class="moozy-footer">
    <div class="footer-buttons">
      <a class="small-btn" href="#">ë¡œê·¸ì¸/ì´ë¦„ ì„¤ì •</a>
      <a class="small-btn" href="#">ì–¸ì–´ë„ ë¬´ë£Œ</a>
      <a class="small-btn" href="#">ê¸°íƒ€</a>
    </div>
  </footer>

  <script src="{% static 'moozy/calendar.js' %}"></script>

<!-- âœ… ì‹œê³„ & ë°°í„°ë¦¬ ì‘ë™ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
  // ì‹œê³„ í‘œì‹œ
  function updateClock() {
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    document.getElementById('clock').textContent = `${hours}:${minutes}`;
  }
  setInterval(updateClock, 1000);
  updateClock();

  // ë°°í„°ë¦¬ í‘œì‹œ
  navigator.getBattery?.().then(function(battery) {
    function updateBatteryLevel() {
      const level = battery.level * 100;
      document.getElementById('battery-fill').style.width = `${level}%`;
    }
    updateBatteryLevel();
    battery.addEventListener('levelchange', updateBatteryLevel);
  });
  function loadDiary(dateStr) {
  fetch(`/calendar/get_entry/?date=${dateStr}`)
    .then(response => response.json())
    .then(data => {
      const container = document.getElementById('diary-box-container');
      container.innerHTML = '';  // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

      const box = document.createElement('div');
      box.className = 'diary-box';

      let html = `<p class="diary-date">${data.date}</p>`;

      if (data.exists) {
        html += `
          <p class="diary-emotion">ê¸°ë¶„: ${data.emotion}</p>
          <p class="diary-note">${data.note}</p>
          <form method="POST" action="/calendar/delete/${data.entry_id}/">
            <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
            <button class="delete-btn">ì‚­ì œ</button>
          </form>
        `;
      } else {
        html += `
          <p class="diary-empty">ì €ì¥ëœ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤!</p>
          <form method="POST" action="/calendar/delete_none/">
            <input type="hidden" name="date" value="${dateStr}">
            <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
            <button class="delete-btn">ì‚­ì œ</button>
          </form>
        `;
      }

      box.innerHTML = html;
      container.appendChild(box);
    });
}

</script>
</body>
</html>